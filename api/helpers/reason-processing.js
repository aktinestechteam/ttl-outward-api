module.exports = {

	friendlyName: 'Reason Processing',

	description: 'store Reason details from txt file into the station database',

	inputs: {
		key1: {type: 'string'},
		key2: {type: 'number'}
	},

	exits: {
		success: {
			outputDescription: "Resons are stored in bulk with respect to the categories.",
		}
	},

	fn: async function (inputs, exits, req, res) {
		var short_ship_codes = [["SSP 1AA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["SSP 1AA2", "CUSTOMER RQST CHANGE DESTINATION"],
		["SSP 1AA3", "CUSTOMER RQST CHANGE FLT-DATE"],
		["SSP 1AA4", "CUSTOMER RQST CHANGE WEIGHT"],
		["SSP 1AA5", "CUSTOMER RQST PRODUCT CHANGE"],
		["SSP 1AA7", "CUSTOMER CHANGE FFR BOOKING CANX"],
		["SSP 1CA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["SSP 1CB1", "OUTSTATION REQUEST CHANGE TO BOOKING"],
		["SSP 1EA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["SSP 1ZA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["SSP 2AE1", "LHR CUST BKG REJECTED YLD-PRTY TOO LOW"],
		["SSP 2CE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["SSP 2CF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["SSP 2CF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["SSP 2CH0", "TRUCK OR FLIGHT CANX"],
		["SSP 2CH1", "REDUCED CARGO OFFER"],
		["SSP 2CJ1", "PREVIOUS OFFLOADS-BACKLOGS"],
		["SSP 2CJ2", "BOOKINGS EXCEED CAPACITY"],
		["SSP 2CJ4", "INBOUND BKG NO SHOW"],
		["SSP 2CK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["SSP 2CO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["SSP 2CO8", "BOOKING REJECTED BY REVENUE MANAGEMENT"],
		["SSP 2EE7", "BOOKING NON-CONFORMANCE"],
		["SSP 2S05", "NO SPECIAL CARGO ON THIS SERVICE"],
		["SSP 4BU1", "VOLUMED OUT NO EXTRA UNITS REQUESTED"],
		["SSP 4BU3", "NOT BUILT NO SPCL ATTACHED NO REASON GIVEN"],
		["SSP 4BU4", "NOT BUILT UNABLE TO SECURE HAZ"],
		["SSP 4BU5", "NOT BUILT OUT OF TIME TO REPLAN"],
		["SSP 4BU6", "2 FLR BUILD INSUFFICIENT TIME TO COMPLETE LVL20"],
		["SSP 4BU7", "NOT PLANNED BY SAP"],
		["SSP 4EE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["SSP 4EF0", "FREIGHT NOT ACCEPTED AT RECEPTION CUSTOMER ERROR"],
		["SSP 4EF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["SSP 4EF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["SSP 4EG7", "FRT DAMAGED"],
		["SSP 4EH0", "TRUCK OR FLIGHT CANX"],
		["SSP 4EH1", "REDUCED CARGO OFFER"],
		["SSP 4EJ2", "BOOKINGS EXCEED CAPACITY"],
		["SSP 4EJ4", "INBOUND BKG NO SHOW"],
		["SSP 4EK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["SSP 4EK5", "OPERATIONAL DISRUPTION"],
		["SSP 4EL1", "DOX ARRIVED NO FREIGHT AT TRANSIT POINT"],
		["SSP 4EL4", "FREIGHT ARRIVED NO DOX AT TRANSIT POINT"],
		["SSP 4EL8", "LATE OR NON ARRIVAL AT RECEPTION OR FRT AND DOX"],
		["SSP 4EM1", "UTL FRT"],
		["SSP 4EM3", "UTL ULD"],
		["SSP 4EN1", "LOADING EQUIPMENT PROBLEMS"],
		["SSP 4EO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["SSP 4EQ2", "LATE OR NON ARRIVAL OF VEHICLE"],
		["SSP 4ER1", "NOT BUILT AT FLIGHT CLOSE"],
		["SSP 4ER2", "ULD DAMAGE"],
		["SSP 4ES1", "LATE OR INCORRECT DELIVERY TO AIRCRAFT"],
		["SSP 4ES3", "OPERATIONAL REQUIREMENT"],
		["SSP 4EW1", "AIRCRAFT CHANGE"],
		["SSP 4EZ1", "BAD WEATHER"],
		["SSP 4EZ2", "INDUSTRIAL ACTION - BA"],
		["SSP 4EZ4", "TERRORISM ACTS OF WAR"],
		["SSP 4FF5", "BA80-MHCS RECORD ERROR"],
		["SSP 4FF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["SSP 4FH0", "TRUCK OR FLIGHT CANX"],
		["SSP 4FH8", "AIRSIDE OPERATIONAL REASONS"],
		["SSP 4FJ5", "CUSTOMER TRANSHIPMENT NO SHOW"],
		["SSP 4FK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["SSP 4FK5", "OPERATIONAL DISRUPTION"],
		["SSP 4FN2", "EQUIPMENT FAILURE"],
		["SSP 4FN3", "WRONG MHCS STATUS CODE"],
		["SSP 4FN5", "MHCS COMPUTER SYSTEM FAILURE"],
		["SSP 4FO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["SSP 4FR1", "NOT BUILT AT FLIGHT CLOSE"],
		["SSP 4FR2", "ULD DAMAGE"],
		["SSP 4FR3", "ULD WEIGHT-IDENTIFICATION PROBLEMS"],
		["SSP 4F4E", "BA80 NIS COMPUTER FAILURE"],
		["SSP 4GH9", "AWB SPLIT MULTIPLE PARTS RESTRICTED"],
		["SSP 4PP1", "NOT POPULATED IN ALERTS"],
		["SSP 4PP2", "LATE INBOUND FLIGHT"],
		["SSP 4PP3", "LATE BREAK OF UNIT"],
		["SSP 4PP4", "FREIGHT IN ASCENTIS"],
		["SSP 4PP5", "ALERTS UNABLE TO COVER"],
		["SSP 4TZ9", "HDQ REQUIREMENT"],
		["SSP 4ZE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["SSP 4ZF0", "FREIGHT NOT ACCEPTED AT RECEPTION CUSTOMER ERROR"],
		["SSP 4ZF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["SSP 4ZF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["SSP 4ZG7", "FRT DAMAGED"],
		["SSP 4ZH0", "TRUCK OR FLIGHT CANX"],
		["SSP 4ZH1", "REDUCED CARGO OFFER"],
		["SSP 4ZJ2", "BOOKINGS EXCEED CAPACITY"],
		["SSP 4PP1", "NOT POPULATED IN ALERTS"],
		["SSP 4PP2", "LATE INBOUND FLIGHT"],
		["SSP 4PP3", "LATE BREAK OF UNIT"],
		["SSP 4PP4", "FREIGHT IN ASCENTIS"],
		["SSP 4PP5", "ALERTS UNABLE TO COVER"],
		["SSP 4TZ9", "HDQ REQUIREMENT"],
		["SSP 4ZE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["SSP 4ZF0", "FREIGHT NOT ACCEPTED AT RECEPTION CUSTOMER ERROR"],
		["SSP 4ZF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["SSP 4ZF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["SSP 4ZG7", "FRT DAMAGED"],
		["SSP 4ZH0", "TRUCK OR FLIGHT CANX"],
		["SSP 4ZH1", "REDUCED CARGO OFFER"],
		["SSP 4ZJ2", "BOOKINGS EXCEED CAPACITY"],
		["SSP 4ZK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["SSP 4ZK6", "GHA ERROR"],
		["SSP 4ZL1", "DOX ARRIVED NO FREIGHT AT TRANSIT POINT"],
		["SSP 4ZL4", "FREIGHT ARRIVED NO DOX AT TRANSIT POINT"],
		["SSP 4ZL8", "LATE OR NON ARRIVAL AT RECEPTION OR FRT AND DOX"],
		["SSP 4ZM1", "UTL FRT"],
		["SSP 4ZN1", "LOADING EQUIPMENT PROBLEMS"],
		["SSP 4ZO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["SSP 4ZR1", "NOT BUILT AT FLIGHT CLOSE"],
		["SSP 4ZR2", "ULD DAMAGE"],
		["SSP 4ZS1", "LATE OR INCORRECT DELIVERY TO AIRCRAFT"],
		["SSP 4ZS3", "OPERATIONAL REQUIREMENT"],
		["SSP 4ZZ1", "BAD WEATHER"],
		["SSP 4ZZ2", "INDUSTRIAL ACTION - BA"],
		["SSP 4ZZ4", "TERRORISM ACTS OF WAR"],			 
					 ];
		
			let offload_codes = [["OFL 1AA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["OFL 1AA2", "CUSTOMER RQST CHANGE DESTINATION"],
		["OFL 1AA3", "CUSTOMER RQST CHANGE FLT-DATE"],
		["OFL 1AA4", "CUSTOMER RQST CHANGE WEIGHT"],
		["OFL 1AA5", "CUSTOMER RQST PRODUCT CHANGE"],
		["OFL 1AA7", "CUSTOMER CHANGE FFR BOOKING CANX"],
		["OFL 1AB3", "CUSTOMER CANCELS BOOKING 3 DAYS OUT - BSA2"],
		["OFL 1AB4", "CUSTOMER CANCELS PART BOOKING 3 DAYS OUT - BSA2"],
		["OFL 1AB5", "CUSTOMER CANCELS BOOKING 5 DAYS OUT - BSA2"],
		["OFL 1AB6", "CUSTOMER CANCELS PART BOOKING 5 DAYS OUT - BSA2"],
		["OFL 1CA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["OFL 1CB1", "OUTSTATION REQUEST CHANGE TO BOOKING"],
		["OFL 1EA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["OFL 1YA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["OFL 1ZA1", "CUST REQ CHANGE TO BOOKING INCLUDING CANX"],
		["OFL 2AE1", "LHR CUST BKG REJECTED YLD-PRTY TOO LOW"],
		["OFL 2CE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["OFL 2CF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["OFL 2CF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["OFL 2CH0", "TRUCK OR FLIGHT CANX"],
		["OFL 2CH1", "REDUCED CARGO OFFER"],
		["OFL 2CJ1", "PREVIOUS OFFLOADS-BACKLOGS"],
		["OFL 2CJ2", "BOOKINGS EXCEED CAPACITY"],
		["OFL 2CJ4", "INBOUND BKG NO SHOW"],
		["OFL 2CK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["OFL 2CO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["OFL 2CO2", "BKG MOVED CALL FORWARD"],
		["OFL 2CO8", "BOOKING REJECTED BY REVENUE MANAGEMENT"],
		["OFL 2CO9", "BOOKING CHANGE TO PREVENT SPLIT SHIPMENT"],
		["OFL 2CS4", "BOOKINGS EXCEED CAPACITY DUE PREMIA BOOKINGS"],
		["OFL 2EE7", "BOOKING NON-CONFORMANCE"],
		["OFL 2S05", "NO SPECIAL CARGO ON THIS SERVICE"],
		["OFL 4BU1", "VOLUMED OUT NO EXTRA UNITS REQUESTED"],
		["OFL 4BU3", "NOT BUILT NO SPCL ATTACHED NO REASON GIVEN"],
		["OFL 4BU4", "NOT BUILT UNABLE TO SECURE HAZ"],
		["OFL 4BU5", "NOT BUILT OUT OF TIME TO REPLAN"],
		["OFL 4BU6", "2 FLR BUILD INSUFFICIENT TIME TO COMPLETE LVL20"],
		["OFL 4BU7", "NOT PLANNED BY SAP"],
		["OFL 4EE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["OFL 4EF0", "FREIGHT NOT ACCEPTED AT RECEPTION CUSTOMER ERROR"],
		["OFL 4EF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["OFL 4EF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["OFL 4EG7", "FRT DAMAGED"],
		["OFL 4EH0", "TRUCK OR FLIGHT CANX"],
		["OFL 4EH1", "REDUCED CARGO OFFER"],
		["OFL 4EJ2", "BOOKINGS EXCEED CAPACITY"],
		["OFL 4EJ4", "INBOUND BKG NO SHOW"],
		["OFL 4EK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["OFL 4EK5", "OPERATIONAL DISRUPTION"],
		["OFL 4EL1", "DOX ARRIVED NO FREIGHT AT TRANSIT POINT"],
		["OFL 4EL4", "FREIGHT ARRIVED NO DOX AT TRANSIT POINT"],
		["OFL 4EL5", "MISSING HAZ DOX"],
		["OFL 4EL8", "LATE OR NON ARRIVAL AT RECEPTION OR FRT AND DOX"],
		["OFL 4EM1", "UTL FRT"],
		["OFL 4EM3", "UTL ULD"],
		["OFL 4EN1", "LOADING EQUIPMENT PROBLEMS"],
		["OFL 4EO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["OFL 4EO2", "BKG MOVED CALL FORWARD"],
		["OFL 4EO3", "RE-BOOKED TO AMEND MANUAL ERROR DURING BOOKING"],
		["OFL 4EQ2", "LATE OR NON ARRIVAL OF VEHICLE"],
		["OFL 4ER1", "NOT BUILT AT FLIGHT CLOSE"],
		["OFL 4ER2", "ULD DAMAGE"],
		["OFL 4ES1", "LATE OR INCORRECT DELIVERY TO AIRCRAFT"],
		["OFL 4ES3", "OPERATIONAL REQUIREMENT"],
		["OFL 4ES5", "OFFLOADED DUE PREMIA OFFLOADS"],
		["OFL 4EW1", "AIRCRAFT CHANGE"],
		["OFL 4EZ1", "BAD WEATHER"],
		["OFL 4EZ2", "INDUSTRIAL ACTION - BA"],
		["OFL 4EZ4", "TERRORISM ACTS OF WAR"],
		["OFL 4FF5", "BA80-MHCS RECORD ERROR"],
		["OFL 4FF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["OFL 4FH0", "TRUCK OR FLIGHT CANX"],
		["OFL 4FH8", "AIRSIDE OPERATIONAL REASONS"],
		["OFL 4FJ5", "CUSTOMER TRANSHIPMENT NO SHOW"],
		["OFL 4FK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["OFL 4FK5", "OPERATIONAL DISRUPTION"],
		["OFL 4FN2", "EQUIPMENT FAILURE"],
		["OFL 4FN3", "WRONG MHCS STATUS CODE"],
		["OFL 4FN5", "MHCS COMPUTER SYSTEM FAILURE"],
		["OFL 4FO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["OFL 4FR1", "NOT BUILT AT FLIGHT CLOSE"],
		["OFL 4FR2", "ULD DAMAGE"],
		["OFL 4FR3", "ULD WEIGHT-IDENTIFICATION PROBLEMS"],
		["OFL 4F4E", "BA80 NIS COMPUTER FAILURE"],
		["OFL 4GH9", "AWB SPLIT MULTIPLE PARTS RESTRICTED"],
		["OFL 4PP1", "NOT POPULATED IN ALERTS"],
		["OFL 4PP2", "LATE INBOUND FLIGHT"],
		["OFL 4PP2", "LATE INBOUND FLIGHT"],
		["OFL 4PP3", "LATE BREAK OF UNIT"],
		["OFL 4PP4", "FREIGHT IN ASCENTIS"],
		["OFL 4PP5", "ALERTS UNABLE TO COVER"],
		["OFL 4TZ9", "HDQ REQUIREMENT"],
		["OFL 4ZE2", "BOOKING REJECTED OR NOT CONFIRMED BY RM"],
		["OFL 4ZF0", "FREIGHT NOT ACCEPTED AT RECEPTION CUSTOMER ERROR"],
		["OFL 4ZF6", "BAWC FAILURE SECURITY CUSTOMS DANG GOODS"],
		["OFL 4ZF7", "NON BAWC FAILURE-SEC-CUST-DANG GOODS"],
		["OFL 4ZG7", "FRT DAMAGED"],
		["OFL 4ZH0", "TRUCK OR FLIGHT CANX"],
		["OFL 4ZH1", "REDUCED CARGO OFFER"],
		["OFL 4ZJ2", "BOOKINGS EXCEED CAPACITY"],
		["OFL 4ZK2", "STAFF OR EQUIPMENT SHORTAGE"],
		["OFL 4ZK6", "GHA ERROR"],
		["OFL 4ZL1", "DOX ARRIVED NO FREIGHT AT TRANSIT POINT"],
		["OFL 4ZL4", "FREIGHT ARRIVED NO DOX AT TRANSIT POINT"],
		["OFL 4ZL8", "LATE OR NON ARRIVAL AT RECEPTION OR FRT AND DOX"],
		["OFL 4ZM1", "UTL FRT"],
		["OFL 4ZN1", "LOADING EQUIPMENT PROBLEMS"],
		["OFL 4ZO1", "BOOKING CHANGED NO EFFECT TO CUSTOMER"],
		["OFL 4ZR1", "NOT BUILT AT FLIGHT CLOSE"],
		["OFL 4ZR2", "ULD DAMAGE"],
		["OFL 4ZS1", "LATE OR INCORRECT DELIVERY TO AIRCRAFT"],
		["OFL 4ZS3", "OPERATIONAL REQUIREMENT"],
		["OFL 4ZZ1", "BAD WEATHER"],
		["OFL 4ZZ2", "INDUSTRIAL ACTION - BA"],
		["OFL 4ZZ4", "TERRORISM ACTS OF WAR"],
		["OFL 4ZZ5", "BAWC INFORMS CUSTOMER NOT TO PRESENT SHIPMENT"]
		];
		reasondetails(short_ship_codes, "Short Ship");
		reasondetails(offload_codes, "Offload");
	}
};

////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////
async function reasondetails(reasons, category){

	let crtrsnCount = 0;
	for (let i=0;i<reasons.length;i++){
		let code = String(reasons[i][0]);
		let explanation = String(reasons[i][1])
		console.log(code +' '+ category +' '+ explanation);

		let data = await Reason.create({ 
			code: code,
			category: category,
			explanation: explanation

		}).fetch().catch(err => console.log( err.message));
		if(data) {
			crtrsnCount= crtrsnCount + 1;
		}
	}
	console.log('++++++++++++++++++++++++'+ crtrsnCount);
}
